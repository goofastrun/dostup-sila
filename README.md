# Система контроля доступа

## Роли в системе

### 1. Администратор (admin)
- Полный доступ к системе
- Управление пользователями (просмотр, удаление)
- Управление ролями пользователей
- Создание и просмотр записей для всех отделов
- Возможность массового удаления пользователей

### 2. Менеджер (manager)
- Просмотр списка пользователей
- Создание и просмотр записей для всех отделов
- Нет доступа к управлению ролями

### 3. Пользователь (user)
- Просмотр записей только своего отдела и общих записей
- Управление своим профилем
- Нет доступа к управлению пользователями и ролями

## Страницы системы

### 1. Страница входа (/login)
- Форма входа (email и пароль)
- Ограничение попыток входа (5 попыток за 5 минут)
- Перенаправление на главную страницу после успешного входа

### 2. Страница регистрации (/register)
- Форма регистрации с полями:
  - Email
  - Пароль
  - Имя
  - Дата рождения
  - Пол
  - Роль
  - Отдел (только для пользователей)

### 3. Главная страница (/)
- Лента записей
- Фильтрация записей по отделам
- Создание новых записей (для админов и менеджеров)
- Возможность прикрепления файлов к записям

### 4. Личный кабинет (/profile)
- Просмотр и редактирование личной информации:
  - Имя
  - Email
  - Дата рождения
- Просмотр информации о роли и отделе

### 5. Страница пользователей (/users)
- Доступна только для админов и менеджеров
- Список всех пользователей с информацией:
  - Имя
  - Email
  - Пол
  - Дата рождения
  - Отдел

### 6. Страница управления ролями (/roles)
- Доступна только для админов
- Изменение ролей пользователей
- Удаление пользователей
- Массовое удаление пользователей (кроме админов)

## Отделы
- Бухгалтерия
- Отдел маркетинга
- Отдел кадров
- Отдел технического контроля
- Отдел сбыта
- Отдел IT
- Отдел логистики и транспорта
- Отдел клиентской поддержки
- Отдел разработки и исследований
- Отдел закупок

## Безопасность
- Ограничение попыток входа (5 попыток за 5 минут)
- Блокировка доступа при превышении лимита попыток
- Автоматическое обнуление счетчика попыток через 5 минут
- Защита от несанкционированного доступа к страницам

## Дополнительные функции
- Загрузка и хранение файлов
- Система уведомлений через toast-сообщения
- Адаптивный дизайн для всех страниц
- Навигационное меню с динамическим отображением пунктов в зависимости от роли

# Система контроля доступа

## Архитектура системы

### База данных (PostgreSQL)
- Хранит все данные системы в двух основных таблицах:
  1. `users` - информация о пользователях:
     - id (уникальный идентификатор)
     - email (почта пользователя)
     - password (пароль)
     - name (имя)
     - birth_date (дата рождения)
     - gender (пол)
     - role (роль в системе)
     - department (отдел)
  
  2. `posts` - записи и публикации:
     - id (уникальный идентификатор)
     - content (содержание записи)
     - department (отдел, к которому относится запись)
     - created_at (дата создания)
     - author_id (ID автора записи)
     - file_url (ссылка на прикрепленный файл)

### Бэкенд (Node.js + Express)
- Запускается в контейнере Backend на порту 3000
- Обрабатывает все запросы к базе данных
- Основные маршруты API:
  - `/api/login` - аутентификация пользователей
  - `/api/register` - регистрация новых пользователей
  - `/api/users` - управление пользователями
  - `/api/posts` - работа с записями
- Использует Redis для хранения сессий и ограничения попыток входа
- Сохраняет загруженные файлы в директорию uploads

### Фронтенд (React + Vite)
- Запускается в контейнере Frontend на порту 8080
- Использует React Query для кэширования и управления состоянием
- Основные страницы:
  - Вход (/login)
  - Регистрация (/register)
  - Главная страница (/)
  - Личный кабинет (/profile)
  - Управление пользователями (/users)
  - Управление ролями (/roles)

### Nginx (Прокси-сервер)
- Работает как обратный прокси
- Перенаправляет запросы:
  - На фронтенд для статических файлов и UI
  - На бэкенд для API-запросов (/api/*)
- Обеспечивает балансировку нагрузки

### Redis (Кэширование)
- Хранит временные данные:
  - Сессии пользователей
  - Счетчики попыток входа
  - Временные блокировки

## Взаимодействие компонентов

1. Пользователь открывает сайт
   - Nginx получает запрос
   - Перенаправляет на Frontend для отображения интерфейса

2. Пользователь выполняет вход
   - Frontend отправляет данные на `/api/login`
   - Nginx перенаправляет запрос на Backend
   - Backend проверяет данные в PostgreSQL
   - Redis отслеживает попытки входа

3. Работа с данными
   - Frontend отправляет запросы через API
   - Backend обрабатывает запросы
   - PostgreSQL хранит все постоянные данные
   - Redis кэширует часто используемые данные

## Развертывание

Система разворачивается через Docker Compose:
```bash
docker-compose up -d
```

Это запустит все необходимые контейнеры:
- Database (PostgreSQL)
- Backend (Node.js)
- Frontend (React)
- Redis
- Nginx

## Роли в системе

// ... keep existing code (roles section)

## Страницы системы

// ... keep existing code (pages section)

## Отделы

// ... keep existing code (departments section)

## Безопасность

// ... keep existing code (security section)

## Дополнительные функции

// ... keep existing code (additional functions section)